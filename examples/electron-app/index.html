<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>@deepgram/electron Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, system-ui, sans-serif; padding: 20px; background: #1a1a2e; color: #eee; }
    h1 { margin-bottom: 20px; font-size: 24px; }
    .controls { margin-bottom: 20px; display: flex; gap: 10px; }
    button { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; }
    #startBtn { background: #0f3460; color: white; }
    #startBtn:hover { background: #16498a; }
    #stopBtn { background: #533483; color: white; }
    #stopBtn:hover { background: #6b44a0; }
    #stopBtn:disabled, #startBtn:disabled { opacity: 0.5; cursor: not-allowed; }
    .status { margin-bottom: 15px; font-size: 14px; color: #888; }
    .status.running { color: #4ecca3; }
    .transcript-area { height: calc(100vh - 160px); overflow-y: auto; border: 1px solid #333; border-radius: 8px; padding: 15px; }
    .transcript-line { margin-bottom: 8px; line-height: 1.5; }
    .source-system { color: #4ecca3; }
    .source-mic { color: #e94560; }
    .interim { opacity: 0.6; font-style: italic; }
    .label { font-weight: 600; font-size: 12px; text-transform: uppercase; margin-right: 8px; }
  </style>
</head>
<body>
  <h1>@deepgram/electron Demo</h1>
  <div class="controls">
    <button id="startBtn" onclick="start()">Start Transcription</button>
    <button id="stopBtn" onclick="stop()" disabled>Stop</button>
  </div>
  <div id="status" class="status">Ready</div>
  <div id="transcripts" class="transcript-area"></div>

  <script>
    const transcripts = document.getElementById('transcripts');
    const status = document.getElementById('status');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');

    async function start() {
      startBtn.disabled = true;
      status.textContent = 'Starting...';
      try {
        await window.deepgram.startTranscription();
        stopBtn.disabled = false;
      } catch (err) {
        status.textContent = 'Error: ' + err.message;
        startBtn.disabled = false;
      }
    }

    async function stop() {
      stopBtn.disabled = true;
      await window.deepgram.stopTranscription();
      startBtn.disabled = false;
    }

    window.deepgram.onTranscript((event) => {
      const div = document.createElement('div');
      div.className = 'transcript-line' + (event.is_final ? '' : ' interim');
      const sourceClass = event.source === 'system' ? 'source-system' : 'source-mic';
      const label = event.source === 'system' ? 'System' : 'Mic';
      div.innerHTML = `<span class="label ${sourceClass}">${label}</span>${event.transcript}`;
      transcripts.appendChild(div);
      transcripts.scrollTop = transcripts.scrollHeight;
    });

    window.deepgram.onStatus((s) => {
      status.textContent = s === 'running' ? 'Transcribing...' : 'Stopped';
      status.className = 'status' + (s === 'running' ? ' running' : '');
    });

    window.deepgram.onError((msg) => {
      const div = document.createElement('div');
      div.className = 'transcript-line';
      div.style.color = '#e94560';
      div.textContent = 'Error: ' + msg;
      transcripts.appendChild(div);
    });
  </script>
</body>
</html>
